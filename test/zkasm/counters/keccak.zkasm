start:

        STEP => A
        0 :ASSERT

        ; to verify that there are no correlations between counters
        0 => A
        CNT_ARITH :ASSERT
        CNT_BINARY :ASSERT
        CNT_MEM_ALIGN :ASSERT
        CNT_KECCAK_F :ASSERT
        CNT_POSEIDON_G :ASSERT
        CNT_PADDING_PG :ASSERT

        ; TEST 135 bytes => counter increase 1 => total = 1

        0 => E
        0 => HASHPOS
        32 => D

        0x5E1268E5B2A8DC1D0BB047386FC227FA4C852DBA596511B9EAF7FCDD79C9006Dn :HASHK(E)
        0x5E1268E5B2A8DC1D0BB047386FC227FA4C852DBA596511B9EAF7FCDD79C9006Dn :HASHK(E)
        0x5E1268E5B2A8DC1D0BB047386FC227FA4C852DBA596511B9EAF7FCDD79C9006Dn :HASHK(E)
        0x5E1268E5B2A8DC1D0BB047386FC227FA4C852DBA596511B9EAF7FCDD79C9006Dn :HASHK(E)
        7 => D
        0x5E1268E5B2A8DCn :HASHK(E)

        135            :HASHKLEN(E)
        $ => A         :HASHKDIGEST(E)

        1 => A
        CNT_KECCAK_F   :ASSERT

        ; TEST 136 bytes => counter increase 2 => total = 3

        E + 1 => E
        0 => HASHPOS
        32 => D

        0x5E1268E5B2A8DC1D0BB047386FC227FA4C852DBA596511B9EAF7FCDD79C9006Dn :HASHK(E)
        0x5E1268E5B2A8DC1D0BB047386FC227FA4C852DBA596511B9EAF7FCDD79C9006Dn :HASHK(E)
        0x5E1268E5B2A8DC1D0BB047386FC227FA4C852DBA596511B9EAF7FCDD79C9006Dn :HASHK(E)
        0x5E1268E5B2A8DC1D0BB047386FC227FA4C852DBA596511B9EAF7FCDD79C9006Dn :HASHK(E)
        8 => D
        0x5E1268E5B2A8DC1Dn :HASHK(E)

        136            :HASHKLEN(E)
        $ => A         :HASHKDIGEST(E)

        3 => A
        CNT_KECCAK_F   :ASSERT

        ; TEST 271 bytes => counter increase 2 => total = 5

        E + 1 => E
        0 => HASHPOS
        32 => D

        0x5E1268E5B2A8DC1D0BB047386FC227FA4C852DBA596511B9EAF7FCDD79C9006Dn :HASHK(E)
        0x5E1268E5B2A8DC1D0BB047386FC227FA4C852DBA596511B9EAF7FCDD79C9006Dn :HASHK(E)
        0x5E1268E5B2A8DC1D0BB047386FC227FA4C852DBA596511B9EAF7FCDD79C9006Dn :HASHK(E)
        0x5E1268E5B2A8DC1D0BB047386FC227FA4C852DBA596511B9EAF7FCDD79C9006Dn :HASHK(E)
        0x5E1268E5B2A8DC1D0BB047386FC227FA4C852DBA596511B9EAF7FCDD79C9006Dn :HASHK(E)
        0x5E1268E5B2A8DC1D0BB047386FC227FA4C852DBA596511B9EAF7FCDD79C9006Dn :HASHK(E)
        0x5E1268E5B2A8DC1D0BB047386FC227FA4C852DBA596511B9EAF7FCDD79C9006Dn :HASHK(E)
        0x5E1268E5B2A8DC1D0BB047386FC227FA4C852DBA596511B9EAF7FCDD79C9006Dn :HASHK(E)
        ; 256

        15 => D
        0x5E1268E5B2A8DC1D0BB047386FC227n :HASHK(E)

        271            :HASHKLEN(E)
        ; $ => A         :HASHKDIGEST(E)

        ; 5 => A
        3 => A
        CNT_KECCAK_F   :ASSERT


        ; TEST 272 bytes => counter increase 3 => total = 8

        E + 1 => E
        0 => HASHPOS
        32 => D

        0x5E1268E5B2A8DC1D0BB047386FC227FA4C852DBA596511B9EAF7FCDD79C9006Dn :HASHK(E)
        0x5E1268E5B2A8DC1D0BB047386FC227FA4C852DBA596511B9EAF7FCDD79C9006Dn :HASHK(E)
        0x5E1268E5B2A8DC1D0BB047386FC227FA4C852DBA596511B9EAF7FCDD79C9006Dn :HASHK(E)
        0x5E1268E5B2A8DC1D0BB047386FC227FA4C852DBA596511B9EAF7FCDD79C9006Dn :HASHK(E)
        0x5E1268E5B2A8DC1D0BB047386FC227FA4C852DBA596511B9EAF7FCDD79C9006Dn :HASHK(E)
        0x5E1268E5B2A8DC1D0BB047386FC227FA4C852DBA596511B9EAF7FCDD79C9006Dn :HASHK(E)
        0x5E1268E5B2A8DC1D0BB047386FC227FA4C852DBA596511B9EAF7FCDD79C9006Dn :HASHK(E)
        0x5E1268E5B2A8DC1D0BB047386FC227FA4C852DBA596511B9EAF7FCDD79C9006Dn :HASHK(E)
        ; 256

        16 => D
        0x5E1268E5B2A8DC1D0BB047386FC227FAn :HASHK(E)

        ; 272            :HASHKLEN(E)
        ; $ => A         :HASHKDIGEST(E)

        ; 8 => A
        ; 5 => A
        3 => A
        CNT_KECCAK_F   :ASSERT

        ; to verify that there are no correlations between counters
        0 => A
        CNT_ARITH :ASSERT
        CNT_BINARY :ASSERT
        CNT_MEM_ALIGN :ASSERT
        CNT_POSEIDON_G :ASSERT
        CNT_PADDING_PG :ASSERT
end:
       0 => A,B,C,D,E,CTX, SP, PC, GAS, MAXMEM, SR, HASHPOS

finalWait:
        ${beforeLast()}  : JMPN(finalWait)

                         : JMP(start)
opINVALID: