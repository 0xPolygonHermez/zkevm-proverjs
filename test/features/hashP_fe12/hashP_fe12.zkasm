; node test/zkasmtest.js -C -e -n Binary,PoseidonG -o tmp test/features/hashP_fe12/hashP_fe12.zkasm

; constants needed by executor C++
CONST %N = 2**19
CONST %MAX_CNT_STEPS_LIMIT = %N
CONST %MAX_CNT_ARITH_LIMIT = %N
CONST %MAX_CNT_BINARY_LIMIT = %N
CONST %MAX_CNT_MEM_ALIGN_LIMIT = %N
CONST %MAX_CNT_KECCAK_F_LIMIT = %N
CONST %MAX_CNT_PADDING_PG_LIMIT = %N
CONST %MAX_CNT_POSEIDON_G_LIMIT = %N

CONSTL %P_BN254 = 21888242871839275222246405745257275088696311157297823662689037894645226208583n

VAR GLOBAL lastHashKId
VAR GLOBAL lastHashPId

VAR GLOBAL initial_A
VAR GLOBAL initial_B
VAR GLOBAL initial_C
VAR GLOBAL initial_D
VAR GLOBAL initial_E
VAR GLOBAL initial_CTX
VAR GLOBAL initial_SP
VAR GLOBAL initial_PC
VAR GLOBAL initial_GAS
VAR GLOBAL initial_SR
VAR GLOBAL initial_RR
VAR GLOBAL initial_HASHPOS
VAR GLOBAL initial_RCX

start:

        STEP => A
        0 :ASSERT


        A           :MSTORE(initial_A)
        B           :MSTORE(initial_B)
        C           :MSTORE(initial_C)
        D           :MSTORE(initial_D)
        E           :MSTORE(initial_E)
        CTX         :MSTORE(initial_CTX)
        SP          :MSTORE(initial_SP)
        PC          :MSTORE(initial_PC)
        GAS         :MSTORE(initial_GAS)
        SR          :MSTORE(initial_SR)
        RR          :MSTORE(initial_RR)
        HASHPOS     :MSTORE(initial_HASHPOS)
        RCX         :MSTORE(initial_RCX)
        0 => A,B,C,D,E,CTX, SP, PC, GAS, SR, RR, HASHPOS, RCX

        -1          :MSTORE(lastHashKId)
        -1          :MSTORE(lastHashPId)

                    :JMP(init)

init:
        7439774195778494536n => A
        8820353827662201067n => B
        1935396539154500959n => C
        102220302338930118528441671286014393463818287010968023791383175708167034112375n :HASHP_FE12

        32377850365086383432987303117864376133611793823662409500334879797650651539055n => A
        39208589398284731158815672976856605281862143850793906317904078337576474660713n => B
        34978401516730469062527721413836229411487280588896376742311170379902872331568n => C
        25088607291158587269364467796921445307977654706365934479375390371722766959132n :HASHP_FE12

        17635282116348775157n => A
        8304360176603426482n => B
        2340390907135132865n => C
        109781152300068156647933309369447503193993045888148238629992586200385395752361n :HASHP_FE12

        69095332865694836717752884588568260116624730537960516421832082999699055580632n => A
        29107018022661510226637380434288002400797335175862469286939545363880853368879n => B
        111763271459511520543371470418914706986590020733971211144031166119514773529670n => C
        31228995969590044711240540194686525998957748133678377653127112162130372795253n :HASHP_FE12

        16757516697195404344n => A
        929073235532871906n => B
        16853362148286756239n => C
        13758671689707977839764061169409147262195440264003257603382574999839258617821n :HASHP_FE12

        73402578750312461230631586120029038942459882624069287874862534679231183555252n => A
        47171580200165403778054144474628618639449125451850424836039162623821559886056n => B
        19866585422428929576809108053948032711777513351831472479566056836939516738982n => C
        61191508632456410855483879130541272289441326940365254499851664431577529500341n :HASHP_FE12

        2490349566352070177n => A
        3764878969210071209n => B
        9733210294057183320n => C
        93194179659977684601696640193311419433813918427000874720175058444891122402040n :HASHP_FE12

        5554376649731744927165851570500330981471738377726730065031275030957278630475n => A
        60747250542300455531110136062984825034471931470133614706145665689117668128163n => B
        23363591507732979729957610987208701408958930874295446578000480103982765892773n => C
        76092340594582476649721913413502773402535322651072104881829261104626273953830n :HASHP_FE12

        2457415118321513312n => A
        6908560961913001969n => B
        382796748184630824n => C
        93028284560044840941733815066398535539005636640744265727723501647724235865913n :HASHP_FE12

        109547680453898971422311297569028841771631279395213636571110251049246466435156n => A
        80991271123970650147690557671635961475420389804658995867789196498027686898449n => B
        24435140593075350979734500365839660927721295615803228392722932707835074234813n => C
        103627669245192054667298496191345108449302654669656434750108863417996432488945n :HASHP_FE12

        9394349671035115269n => A
        8009763902757961934n => B
        12877609710057943925n => C
        49268548585175436145317669211865210722271167308894196822243116938594225968926n :HASHP_FE12

        10774011414778660960668903336373272605216707950807090443952630134208644757098n => A
        41748535594076550257305106192402918763035209022819714951624980174856196787079n => B
        63856178863541249149147863269128344841035094068649128152235099140192939450211n => C
        52701156986098889055588112666834060361323599757924218566320617466482542097623n :HASHP_FE12

        9275698628621952923n => A
        3669800398300728669n => B
        17687643853299656177n => C
        65010139576796778092313022045904931230007049946120475007285040615651134300388n :HASHP_FE12

        90580806538933197348693850037086194841002487028726201454791320452700259395329n => A
        46713172959778766217491600830341877704126192971157202903971685036300295617203n => B
        82959448426409429530566623829126690660341193144271000111816013032952443390525n => C
        2346185659729305114538216890676694150115357551330483423299175438139829799817n :HASHP_FE12

        5102735370967644483n => A
        7315755721411587016n => B
        4054796898896042781n => C
        67158428783827273950492337218915680001603634829559506908073712509234751255547n :HASHP_FE12

        15314372540432408803101720809993561425989127560733259574414440669863354819419n => A
        64092334938871121784349429033125632936041881023430294767589100330220467982854n => B
        58016549929896976231596214183553680679350974123608787430573119369095569756060n => C
        46044625760015322915536947666833730877320592803379794291781070068648004562419n :HASHP_FE12

        4553763238759950501n => A
        6950419733224864868n => B
        12442990584725843227n => C
        111688380238853451930990221846412153186539102703870097672742562813973844024621n :HASHP_FE12

        70052212973522695780921785667642550368919122678741389224032264288983726160037n => A
        99009802904627622718255067743971929884167457335262615411910320792552098777576n => B
        32568198736260364470479330484196499053731741823969227893547839271956626327388n => C
        69982189628011534301880017375294642726675201179425342558324792302919859639276n :HASHP_FE12

        16882263291292450377n => A
        17966565959889849463n => B
        5339684416767056700n => C
        69706761628240151473115765103557677368103715688007939507203445248360125302701n :HASHP_FE12

        51445565519252693544579410796538432653654975064430939825840093874214038295904n => A
        78666498958076256292246971335851960678462065657426137257440215506073504785111n => B
        39083509861470639295907715453660515244108715133637269763744998849674750734995n => C
        22322369185210284787404490381571867206726472171942606918985715033841213589424n :HASHP_FE12

        3073431275661473498n => A
        6575258535334083716n => B
        13271161499161728508n => C
        23910639126462686568044324407932747690597798197503795143573825971893696544634n :HASHP_FE12

        43272812726190371622169840168162875660899853320586286599569192681013310598761n => A
        32801194164494684324332239432946033858626862083313097497826592496532276876974n => B
        57450347717651377670535108076062690160365808124938331703545915871913495909627n => C
        47850539596612291534617957077137878302128225281405931952501842199467807492054n :HASHP_FE12

        16859086986506203568n => A
        12140768990102176453n => B
        16228409688322299001n => C
        107776155828559755137778775290929894872358141210627375915775496923946200114932n :HASHP_FE12

        5143465440277689972954909766809078092741814855487387161829338938001246745830n => A
        112323573151770619336481738888840200672530215954546117048427123814208623642566n => B
        23863872199935695276665413020676081475069048660323824949706900407937019170108n => C
        83669918721190870095631371363000460590723176609730154750614697132417823400380n :HASHP_FE12

        8529785651523530196n => A
        9284491662629448601n => B
        12059892148463147033n => C
        21938477639698272749906810216728847705104435532522844767448580718780656292685n :HASHP_FE12

        22116089451447448762509307735835908528452345742953740724369236149091265643620n => A
        38855313868157974909786638795685602695970659061041413606734657269738273823080n => B
        41781778681874045354957396143732315375638848237951971591293658630532486874455n => C
        42785514258470626490773541416637753293727564453142692993896476930209973087273n :HASHP_FE12

        16119140960634490620n => A
        3375230960159138166n => B
        15562638706538562272n => C
        77775109047405505695191339336788077503340260141968752855961349763901375024173n :HASHP_FE12

        59088511811152759779426611693334944113047149126079184996814067426562009942781n => A
        103337542000802582218411463819877854195079402849238371537304869766884834195142n => B
        37779615654400051845498049990886586999769589337207011950560467739511431484455n => C
        69252205174384070202630298548503135969136477611060279957768119222615293310381n :HASHP_FE12

        11243188051817898905n => A
        16959091944469103765n => B
        6613817178405425772n => C
        43710651693869409289958781304869351178672973335329792935227922710256977932393n :HASHP_FE12

        5514294218186185527523397807895257072268045863379611912215255260138768334241n => A
        9955673077125838072689845145393767858546913664100777616574106846180300061638n => B
        20707216963291446248288798167412420379109671316201777232372801823944478672503n => C
        115711892960573649493594132207538605254486275532854330794124067142249618006157n :HASHP_FE12

        ; The following should fail
        ; 5514294218186185527523397807895257072268045863379611912215255260138768334241n => A
        ; 9955673077125838072689845145393767858546913664100777616574106846180300061638n => B
        ; 2070721696329144624828879816741242037910967131620177723237280182394447867250333333n => C
        ; 49112514097767276124472288998860046020525674046851032197305463678805487128252n :HASHP_FE12

end:

        $ => A           :MLOAD(initial_A)
        $ => B           :MLOAD(initial_B)
        $ => C           :MLOAD(initial_C)
        $ => D           :MLOAD(initial_D)
        $ => E           :MLOAD(initial_E)
        $ => CTX         :MLOAD(initial_CTX)
        $ => SP          :MLOAD(initial_SP)
        $ => PC          :MLOAD(initial_PC)
        $ => GAS         :MLOAD(initial_GAS)
        $ => SR          :MLOAD(initial_SR)
        $ => RR          :MLOAD(initial_RR)
        $ => HASHPOS     :MLOAD(initial_HASHPOS)
        $ => RCX         :MLOAD(initial_RCX)

; label finalizeExecution needed by executor C++
finalizeExecution:
        ${beforeLast()}  : JMPN(finalizeExecution)

                         : JMP(start)
opINVALID:
; label checkAndSaveFrom needed by executor C++
checkAndSaveFrom:
                         :JMP(opINVALID)